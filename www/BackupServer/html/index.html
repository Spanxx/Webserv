<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Our beautiful webserver</title>
	<style>
		body {
		font-family: Arial, sans-serif;
		text-align: center;
		padding: 50px;
		background-color: #e2d5ff;
		color: #333;
		}
		div {
		background-color: #ffffff;
		border-radius: 10px;
		box-shadow: 0 0 15px rgba(0,0,0,0.1);
		width: 500px;
		height: 200px;
		}
		h1 {
		font-size: 72px;
		margin-bottom: 0;
		}
		p {
		font-size: 24px;
		margin-top: 5px;
		color: #666;
		}
		form {
		font-family: Georgia, 'Times New Roman', Times, serif;
		font-size: 24px;
		margin-top: 30px;
		text-align: center;
		color: #666;
			}
		.container {
		background-color: rgb(163, 244, 255);
		padding: 40px;
		border-radius: 10px;
		display: inline-block;
		box-shadow: 0 0 15px rgba(0,0,0,0.1);
		width: 50%;
		}
	</style>
</head>
<body>
	<h1>Hello from C++ Server with created response!</h1>
	<p>"I used to be addicted to soap, but I'm clean now."</p>
	<br><br>

	<h2>Please enter your name</h2>
	<form action="cgi-bin/hello.php" method="GET">
		<input type="text" name="name" id="name">
		<input type="submit" value="Say Hi">
	</form>

	<br><br>

	<h2>Upload a File</h2>

	<form action="cgi-bin/upload.py" method="POST" enctype="multipart/form-data">
		<input type="file" name="file">
		<button type="submit">Upload</button>
	</form>

	<form method="POST" action="{{UPLOAD_BLOCK}}" enctype="multipart/form-data">
		<input type="file" name="file" />
		<button type="submit">Upload to disc without CGI</button>
	</form>

	<br><br>

	<h2>Delete Uploaded File</h2>
	<label for="fileSelect">Choose a file:</label>
	<select id="fileSelect">
		<option value="">-- Select a file --</option>
	</select>

	<script>
	fetch('cgi-bin/list_files.py')
		.then(res => res.json())
		.then(files => {
			const select = document.getElementById('fileSelect');
			files.forEach(file => {
				const option = document.createElement('option');
				option.value = file;
				option.textContent = file;
				select.appendChild(option);
			});
		})
		.catch(err => {
			console.error('Error loading files:', err);
		});
	</script>

	<br><br>

	<button id="deleteBtn" style="display: none;">Delete Selected File</button>
	<script>
		const select = document.getElementById('fileSelect');
		const deleteBtn = document.getElementById('deleteBtn');

		select.addEventListener('change', () => {
			deleteBtn.style.display = select.value ? 'inline-block' : 'none';
		});

		deleteBtn.addEventListener('click', () => {
			const filename = select.value;
			if (!filename) return;

			fetch(`{{UPLOAD_BLOCK}}${filename}`, {
				method: 'DELETE'
			})
			.then(response => {
				if (response.ok) {
					alert(`Deleted: ${filename}`);
					// Optionally remove from dropdown
					select.querySelector(`option[value="${filename}"]`).remove();
					select.value = '';
					deleteBtn.style.display = 'none';
				} else {
					alert('Failed to delete file.');
				}
				window.location.href = '/index.html';
			})
			.catch(error => {
				console.error('Error:', error);
				alert('Error sending request.');
			});
			// location.reload();
		});
	</script>
</body>
</html>

